# ๐ต Forecasting System
## ๐ Predictive Analytics using LSTM, Prophet & Streamlit

ะญัะพั ะฟัะพะตะบั โ ะฟะพะปะฝะพัะตะฝะฝะฐั ัะธััะตะผะฐ ะดะปั ะฐะฝะฐะปะธะทะฐ ะธ ะฟัะพะณะฝะพะทะธัะพะฒะฐะฝะธั ะบัััะฐ USD โ UZS ะฝะฐ ะฑะฐะทะต:

- **LSTM (PyTorch)** โ ะณะปัะฑะพะบะพะต ะพะฑััะตะฝะธะต
- **Prophet (Meta)** โ ััะฐัะธััะธัะตัะบะพะต ะฟัะพะณะฝะพะทะธัะพะฒะฐะฝะธะต
- **Streamlit** โ ะธะฝัะตัะฐะบัะธะฒะฝัะน ะฒะตะฑ-ะธะฝัะตััะตะนั

ะัะพะตะบั ะฟะพะปะฝะพัััั ะฐะฒัะพะฝะพะผะตะฝ: ะฒะบะปััะฐะตั ะฟะพะดะณะพัะพะฒะบั ะดะฐะฝะฝัั, ะพะฑััะตะฝะธะต, ะฟัะพะณะฝะพะท, ะฒะธะทัะฐะปะธะทะฐัะธั ะธ ััะฐะฒะฝะตะฝะธะต ะผะพะดะตะปะตะน.

---

## ๐ ะะพะทะผะพะถะฝะพััะธ

### ๐ค ะัะพะณะฝะพะทะธัะพะฒะฐะฝะธะต
- LSTM ะผะพะดะตะปั ั ะพะฑััะตะฝะธะตะผ ะฟะพ ะธััะพัะธัะตัะบะธะผ ะดะฐะฝะฝัะผ
- Prophet ะผะพะดะตะปั ะดะปั ะฑัััััั ััะฐัะธััะธัะตัะบะธั ะฟัะพะณะฝะพะทะพะฒ
- ะกัะฐะฒะฝะตะฝะธะต LSTM vs Prophet

### ๐ ะะธะทัะฐะปะธะทะฐัะธั
- ะััะพัะธั ะบัััะฐ
- KPI ะฒะฐะปััะฝะพะณะพ ััะดะฐ
- ะัะพะณะฝะพะทั ั ะทะพะฝะฐะผะธ ัะพััะฐ/ะฟะฐะดะตะฝะธั
- ะะพะฒะตัะธัะตะปัะฝัะต ะธะฝัะตัะฒะฐะปั Prophet
- ะขะพัะบะธ ะธะทะผะตะฝะตะฝะธั ััะตะฝะดะฐ

### ๐งฑ ML Pipeline
- ะัะตะดะพะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั
- ะะฐะฟะพะปะฝะตะฝะธะต ะฟัะพะฟััะบะพะฒ
- ะะฝะถะตะฝะตัะธั ะฟัะธะทะฝะฐะบะพะฒ
- ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต
- ะขัะตะฝะธัะพะฒะบะฐ ะธ ัะพััะฐะฝะตะฝะธะต ะผะพะดะตะปะธ
- ะัะพะฒะตัะบะฐ ะบะฐัะตััะฒะฐ ะธ ะณัะฐัะธะบะธ

---
## System Architecture
![ML System Architecture](img/full_pipeline(vert).svg)

## ะะพะดัะพะฑะฝัะต ะฐััะธัะตะบัััะฝัะต ะดะธะฐะณัะฐะผะผั

#### 1. Data Pipeline - Fetching Data
![Fetching Data Pipeline](img/fetch_data_result.svg)


#### 2. Data Pipeline - Preprocessing
![Data Preprocessing Pipeline](img/preprocessing.svg)

#### 3. Dataset Pipeline - Windows / Scaler / Split
![Dataset Preparation Pipeline](img/min_max.svg)

#### 4. Training Pipeline - LSTM Training Loop
![LSTM Training Pipeline](img/train_graph.svg)

#### 5. Prophet Model Pipeline
![Prophet Forecast Pipeline](img/prophet.svg)

---

## ๐งฑ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ
```
.
โโโ src/
โ   โโโ preprocessing/
โ   โ   โโโ preprocess.py # ๐งน ะัะธััะบะฐ ะดะฐะฝะฝัั, ะทะฐะฟะพะปะฝะตะฝะธะต ะฟัะพะฟััะบะพะฒ, feature engineering.
โ   โ
โ   โโโ model/
โ   โ   โโโ dataset.py # ๐งฉ ะะพะดะณะพัะพะฒะบะฐ: ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต (Scaler), ัะพะทะดะฐะฝะธะต ะฒัะตะผะตะฝะฝัั ะพะบะพะฝ (Sequences).
โ   โ   โโโ model_lstm.py # ๐ง ะััะธัะตะบัััะฐ: ะบะปะฐัั ะผะฝะพะณะพัะปะพะนะฝะพะน LSTM ะผะพะดะตะปะธ.
โ   โ   โโโ predict.py # ๐ฎ ะัะพะณะฝะพะท: ะทะฐะณััะทะบะฐ ะผะพะดะตะปะธ ะธ ะฒัะฟะพะปะฝะตะฝะธะต ะธัะตัะฐัะธะฒะฝะพะณะพ (ัะตะบัััะธะฒะฝะพะณะพ) ะฟัะพะณะฝะพะทะฐ.
โ   โ   โโโ train.py # ๐ฏ ะะฑััะตะฝะธะต: ัะธะบะป ััะตะฝะธัะพะฒะบะธ, ัะพััะฐะฝะตะฝะธะต ะปัััะตะน ะผะพะดะตะปะธ ะธ ะผะตััะธะบ.
โ   โ
โ   โโโ web/
โ       โโโ app.py # ๐ฅ๏ธ Streamlit: ะธะฝัะตัะฐะบัะธะฒะฝัะน ะดะฐัะฑะพัะด ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ ะฟัะพะณะฝะพะทะพะฒ.
โ
โโโ data/
โ   โโโ raw/
โ   โ   โโโ usd_rates.csv # ๐ ะกัััะต ะดะฐะฝะฝัะต, ะทะฐะณััะถะตะฝะฝัะต ะธะท API ะฆะ (ั ะฟัะพะฟััะบะฐะผะธ).
โ   โ
โ   โโโ processed/
โ       โโโ usd_preprocessed.csv # โ ะะพัะพะฒัะต ะดะฐะฝะฝัะต: ะพัะธัะตะฝะฝัะต ะธ ะพะฑะพะณะฐัะตะฝะฝัะต ะฟัะธะทะฝะฐะบะฐะผะธ.
โ       โโโ usd_forecast.csv # ๐ ะะตะทัะปััะฐั ะฟัะพะณะฝะพะทะฐ LSTM.
โ       โโโ usd_prophet_forecast.csv # ๐ ะะตะทัะปััะฐั ะฟัะพะณะฝะพะทะฐ Prophet.
โ       โโโ lstm_test_predictions.csv # ๐ ะกัะฐะฒะฝะตะฝะธะต Real vs Pred ะฝะฐ ัะตััะพะฒะพะผ ะฝะฐะฑะพัะต.
โ
โโโ models/
โ   โโโ lstm_usd_model.pth # ๐พ ะะตัะฐ ะพะฑััะตะฝะฝะพะน LSTM ะผะพะดะตะปะธ.
โ   โโโ scaler.pkl # ๐ ะกะพััะฐะฝะตะฝะฝัะน MinMaxScaler.
โ   โโโ model_config.json # โ๏ธ ะะฐัะฐะผะตััั ะผะพะดะตะปะธ (window_size, hidden_size ะธ ั.ะด.).
โ   โโโ loss_curve.png # ๐ผ๏ธ ะัะฐัะธะบ ะธััะพัะธะธ ะพะฑััะตะฝะธั (Loss Curve).
โ   โโโ loss_curve.csv
โ   โโโ metrics.json # โญ ะคะธะฝะฐะปัะฝัะต ะผะตััะธะบะธ (MAE, RMSE) ะฝะฐ ัะตััะต.
โ
โโโ pyproject.toml # ๐ฆ ะะพะฝัะธะณััะฐัะธั ะฟัะพะตะบัะฐ ะธ ะทะฐะฒะธัะธะผะพััะธ.
โโโ README.md # ๐ ะะปะฐะฒะฝัะน ัะฐะนะป ะฟัะพะตะบัะฐ.
```
---

## ๐ง ะฃััะฐะฝะพะฒะบะฐ

### 1. ะะปะพะฝะธััะนัะต ะฟัะพะตะบั
```bash
git clone git@github.com:dadaxonEnigma/currency_forecast.git
cd currency_forecast
```
### 2. ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ
```bash
pip install .
```

#### ๐ฅ 1. ะัะตะดะพะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั
ะะปั ะฝะฐัะฐะปะฐ ะฝัะถะฝะพ ัะพะทะดะฐัั ะพะฑัะฐะฑะพัะฐะฝะฝัะน ะดะฐัะฐัะตั:

```bash
python src/preprocessing/preprocess.py
```
ะะพัะปะต ะฒัะฟะพะปะฝะตะฝะธั ะฟะพัะฒะธััั:
data/processed/usd_preprocessed.csv

#### ๐ ะัะธะผะตั ะฒะธะทัะฐะปะธะทะฐัะธะธ
![alt text](img/rate_data.png)
![alt text](img/preprocessing.png)

#### ๐ค 2. ะะฑััะตะฝะธะต LSTM ะผะพะดะตะปะธ
ะะฐะฟัััะธัะต ััะตะฝะธัะพะฒะบั:

```bash
python src/model/train.py
```
#### ๐ Loss Curve (ะฟัะธะผะตั)
![alt text](img/learning_curve.png)

#### ๐ฎ 3. ะะตะฝะตัะฐัะธั ะฟัะพะณะฝะพะทะฐ
### ะัะพะณะฝะพะท LSTM:
```bash
python src/model/predict.py
```
### ะัะพะณะฝะพะท Prophet:
```bash
python -c "from src.model.prophet_model import train_prophet; train_prophet(days=30)"
```

## ๐ฅ 4. ะะฐะฟััะบ Streamlit UI
```bash
streamlit run src/web/app.py
```
ะัะธะปะพะถะตะฝะธะต ะฒะบะปััะฐะตั ะฒะบะปะฐะดะบะธ:
* ๐ ะััะพัะธั

* ๐ LSTM ะฟัะพะณะฝะพะท

* ๐ฎ Prophet ะฟัะพะณะฝะพะท

* โ๏ธ ะกัะฐะฒะฝะตะฝะธะต ะผะพะดะตะปะตะน

* ๐ ะัะธะผะตั ะฒะธะทัะฐะปะธะทะฐัะธะน

### ะััะพัะธั + ะฟัะพะณะฝะพะท LSTM
![alt text](img/pred_lstm.png)

### ะัะพะณะฝะพะท Prophet
![alt text](img/pred_prophet.png)
![alt text](img/pred_prophet2.png)

### ะกัะฐะฒะฝะตะฝะธะต ะผะพะดะตะปะตะน
![alt text](img/compare_models.png)

## ๐ค ะะฒัะพั
Dadakhon Turgunboev
Machine Learning Engineer
GitHub: [https://github.com/dadaxonEnigma](https://github.com/dadaxonEnigma)

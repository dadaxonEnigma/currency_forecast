# üíµ Forecasting System
## üìà Predictive Analytics using LSTM, Prophet & Streamlit

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∫—É—Ä—Å–∞ USD ‚Üí UZS –Ω–∞ –±–∞–∑–µ:

- **LSTM (PyTorch)** ‚Äî –≥–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- **Prophet (Meta)** ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Streamlit** ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–µ–Ω: –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏–µ, –ø—Ä–æ–≥–Ω–æ–∑, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ü§ñ –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
- LSTM –º–æ–¥–µ–ª—å —Å –æ–±—É—á–µ–Ω–∏–µ–º –ø–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º
- Prophet –º–æ–¥–µ–ª—å –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ LSTM vs Prophet

### üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- –ò—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–∞
- KPI –≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—è–¥–∞
- –ü—Ä–æ–≥–Ω–æ–∑—ã —Å –∑–æ–Ω–∞–º–∏ —Ä–æ—Å—Ç–∞/–ø–∞–¥–µ–Ω–∏—è
- –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã Prophet
- –¢–æ—á–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞

### üß± ML Pipeline
- –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
- –ò–Ω–∂–µ–Ω–µ—Ä–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏

---
## System Architecture
![ML System Architecture](img/full_pipeline(vert).svg)

## –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã

#### 1. Data Pipeline - Fetching Data
![Fetching Data Pipeline](img/fetch_data_result.svg)


#### 2. Data Pipeline - Preprocessing
![Data Preprocessing Pipeline](img/preprocessing.svg)

#### 3. Dataset Pipeline - Windows / Scaler / Split
![Dataset Preparation Pipeline](img/min_max.svg)

#### 4. Training Pipeline - LSTM Training Loop
![LSTM Training Pipeline](img/train_graph.svg)

#### 5. Prophet Model Pipeline
![Prophet Forecast Pipeline](img/prophet.svg)

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
.
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ preprocessing/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ preprocess.py # üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤, feature engineering.
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dataset.py # üß© –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (Scaler), —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫–æ–Ω (Sequences).
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model_lstm.py # üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –∫–ª–∞—Å—Å –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–π LSTM –º–æ–¥–µ–ª–∏.
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ predict.py # üîÆ –ü—Ä–æ–≥–Ω–æ–∑: –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ) –ø—Ä–æ–≥–Ω–æ–∑–∞.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ train.py # üéØ –û–±—É—á–µ–Ω–∏–µ: —Ü–∏–∫–ª —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –º–µ—Ç—Ä–∏–∫.
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ web/
‚îÇ       ‚îî‚îÄ‚îÄ app.py # üñ•Ô∏è Streamlit: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤.
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usd_rates.csv # üìÑ –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑ API –¶–ë (—Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏).
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ processed/
‚îÇ       ‚îú‚îÄ‚îÄ usd_preprocessed.csv # ‚úÖ –ì–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ—á–∏—â–µ–Ω–Ω—ã–µ –∏ –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.
‚îÇ       ‚îú‚îÄ‚îÄ usd_forecast.csv # üìà –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞ LSTM.
‚îÇ       ‚îú‚îÄ‚îÄ usd_prophet_forecast.csv # üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞ Prophet.
‚îÇ       ‚îî‚îÄ‚îÄ lstm_test_predictions.csv # üìâ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Real vs Pred –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ.
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ lstm_usd_model.pth # üíæ –í–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π LSTM –º–æ–¥–µ–ª–∏.
‚îÇ   ‚îú‚îÄ‚îÄ scaler.pkl # üìê –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π MinMaxScaler.
‚îÇ   ‚îú‚îÄ‚îÄ model_config.json # ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ (window_size, hidden_size –∏ —Ç.–¥.).
‚îÇ   ‚îú‚îÄ‚îÄ loss_curve.png # üñºÔ∏è –ì—Ä–∞—Ñ–∏–∫ –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è (Loss Curve).
‚îÇ   ‚îú‚îÄ‚îÄ loss_curve.csv
‚îÇ   ‚îî‚îÄ‚îÄ metrics.json # ‚≠ê –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (MAE, RMSE) –Ω–∞ —Ç–µ—Å—Ç–µ.
‚îÇ
‚îú‚îÄ‚îÄ pyproject.toml # üì¶ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.
‚îî‚îÄ‚îÄ README.md # üìñ –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–æ–µ–∫—Ç–∞.
```
---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
```bash
git clone git@github.com:dadaxonEnigma/currency_forecast.git
cd currency_forecast
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
Windows:
```bash
python -m venv venv
venv\Scripts\activate
```
Linux/macOS:
```bash
python3 -m venv venv
source venv/bin/activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pyproject.toml, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ:
```bash
pip install .
```
–ï—Å–ª–∏ Prophet –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è (—á–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞), –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é:
```bash
pip install prophet
```
### 4. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–í–∞—Ä–∏–∞–Ω—Ç A - –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π:
```bash
python -m src.data_loader.fetch_data --last 2000
```
–í–∞—Ä–∏–∞–Ω—Ç B - –∑–∞ –ø–µ—Ä–∏–æ–¥:
```bash
python -m src.data_loader.fetch_data --start 2018-12-01 --end 2025-12-03
```
–ü–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª:
```bash
data/raw/usd_rates.csv
```

### üì• 5. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–°–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª usd_preprocessed.csv –∏ —Ñ–∏—á–∏.
```bash
python -m src.preprocessing.preprocess
```
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è:
data/processed/usd_preprocessed.csv

#### üìä –ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
![alt text](img/rate_data.png)
![alt text](img/preprocessing.png)

### ü§ñ 6. –û–±—É—á–µ–Ω–∏–µ LSTM –º–æ–¥–µ–ª–∏
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É:
```bash
python -m src.model.train
```
#### üìâ Loss Curve (–ø—Ä–∏–º–µ—Ä)
![alt text](img/learning_curve.png)

## üñ• 7. –ó–∞–ø—É—Å–∫ Streamlit UI
```bash
streamlit run src/web/app.py
```
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç –≤–∫–ª–∞–¥–∫–∏:
* üìò –ò—Å—Ç–æ—Ä–∏—è

* üìà LSTM –ø—Ä–æ–≥–Ω–æ–∑

* üîÆ Prophet –ø—Ä–æ–≥–Ω–æ–∑

* ‚öîÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

* üìä –ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π

### –ò—Å—Ç–æ—Ä–∏—è + –ø—Ä–æ–≥–Ω–æ–∑ LSTM
![alt text](img/pred_lstm.png)

### –ü—Ä–æ–≥–Ω–æ–∑ Prophet
![alt text](img/pred_prophet.png)
![alt text](img/pred_prophet2.png)

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
![alt text](img/compare_models.png)

## ü§ù –ê–≤—Ç–æ—Ä
Dadakhon Turgunboev
Machine Learning Engineer
GitHub: [https://github.com/dadaxonEnigma](https://github.com/dadaxonEnigma)

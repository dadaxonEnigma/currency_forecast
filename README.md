# ğŸ’µ Forecasting System
## ğŸ“ˆ Predictive Analytics using LSTM, Prophet & Streamlit

Ğ­Ñ‚Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ â€” Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºÑƒÑ€ÑĞ° USD â†’ UZS Ğ½Ğ° Ğ±Ğ°Ğ·Ğµ:

- **LSTM (PyTorch)** â€” Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ
- **Prophet (Meta)** â€” ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- **Streamlit** â€” Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ²ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ°Ğ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼ĞµĞ½: Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºÑƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…, Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ, Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·, Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹.

---

## ğŸš€ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

### ğŸ¤– ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- LSTM Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸ĞµĞ¼ Ğ¿Ğ¾ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼
- Prophet Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¾Ğ²
- Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ LSTM vs Prophet

### ğŸ“Š Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ ĞºÑƒÑ€ÑĞ°
- KPI Ğ²Ğ°Ğ»ÑÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ñ€ÑĞ´Ğ°
- ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ñ‹ Ñ Ğ·Ğ¾Ğ½Ğ°Ğ¼Ğ¸ Ñ€Ğ¾ÑÑ‚Ğ°/Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ñ
- Ğ”Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ñ‹ Prophet
- Ğ¢Ğ¾Ñ‡ĞºĞ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ñ‚Ñ€ĞµĞ½Ğ´Ğ°

### ğŸ§± ML Pipeline
- ĞŸÑ€ĞµĞ´Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ¾Ğ²
- Ğ˜Ğ½Ğ¶ĞµĞ½ĞµÑ€Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞºĞ¾Ğ²
- ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ¸ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸

---
## System Architecture
![ML System Architecture](img/full_pipeline(vert).svg)
## ğŸ§± Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
ğŸ“¦ project
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ preprocessing/
â”‚   â”‚   â””â”€â”€ preprocess.py
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ dataset.py
â”‚   â”‚   â”œâ”€â”€ model_lstm.py
â”‚   â”‚   â”œâ”€â”€ predict.py
â”‚   â”‚   â””â”€â”€ train.py
â”‚   â””â”€â”€ web/
â”‚       â””â”€â”€ app.py     â† Streamlit Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/
â”‚   â”‚   â””â”€â”€ usd_rates.csv
â”‚   â””â”€â”€ processed/
â”‚       â”œâ”€â”€ usd_preprocessed.csv
â”‚       â”œâ”€â”€ usd_forecast.csv
â”‚       â”œâ”€â”€ usd_prophet_forecast.csv
â”‚       â””â”€â”€ lstm_test_predictions.csv
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ lstm_usd_model.pth
â”‚   â”œâ”€â”€ scaler.pkl
â”‚   â”œâ”€â”€ model_config.json
â”‚   â”œâ”€â”€ loss_curve.png
â”‚   â”œâ”€â”€ loss_curve.csv
â”‚   â””â”€â”€ metrics.json
â”‚
â”œâ”€â”€ pyproject.toml
â””â”€â”€ README.md

---

## ğŸ”§ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

### 1. ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
```bash
git clone git@github.com:dadaxonEnigma/currency_forecast.git
cd currency_forecast
```
### 2. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
```bash
pip install .
```

## ğŸ“¥ 1. ĞŸÑ€ĞµĞ´Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
Ğ”Ğ»Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚:

```bash
python src/preprocessing/preprocess.py
```
ĞŸĞ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑÑ:
data/processed/usd_preprocessed.csv

### ğŸ“Š ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
![alt text](img/rate_data.png)
![alt text](img/preprocessing.png)

## ğŸ¤– 2. ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ LSTM Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ñ‚Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºÑƒ:

```bash
python src/model/train.py
```
### ğŸ“‰ Loss Curve (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€)
![alt text](img/learning_curve.png)

## ğŸ”® 3. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ°
### ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ· LSTM:
```bash
python src/model/predict.py
```
### ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Prophet:
```bash
python -c "from src.model.prophet_model import train_prophet; train_prophet(days=30)"
```

## ğŸ–¥ 4. Ğ—Ğ°Ğ¿ÑƒÑĞº Streamlit UI
```bash
streamlit run src/web/app.py
```
ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸:
* ğŸ“˜ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ

* ğŸ“ˆ LSTM Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·

* ğŸ”® Prophet Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·

* âš”ï¸ Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹

* ğŸ“Š ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¹

### Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ + Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ· LSTM
![alt text](img/pred_lstm.png)

### ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ· Prophet
![alt text](img/pred_prophet.png)
![alt text](img/pred_prophet2.png)

### Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
![alt text](img/compare_models.png)

## ğŸ§  ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° LSTM
text
Input (window_size)
        â†“
      LSTM layers
        â†“
 Optional Activation
        â†“
       Linear
        â†“
     Output (forecast)

## ğŸ¤ ĞĞ²Ñ‚Ğ¾Ñ€
Dadakhon Turgunboev
Machine Learning Engineer
GitHub: [https://github.com/yourprofile](https://github.com/dadaxonEnigma)
